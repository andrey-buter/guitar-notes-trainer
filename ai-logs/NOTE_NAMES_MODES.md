# –†–µ–∂–∏–º—ã –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è –Ω–∞–∑–≤–∞–Ω–∏–π –Ω–æ—Ç

## –û–±–∑–æ—Ä

–ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –¥–≤–∞ —Ä–µ–∂–∏–º–∞ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è –Ω–∞–∑–≤–∞–Ω–∏–π –Ω–æ—Ç (A, B, C, D, E, F, G) –≤–º–µ—Å—Ç–æ –Ω–æ–º–µ—Ä–æ–≤ –ª–∞–¥–æ–≤ –Ω–∞ —Ç–∞–±—É–ª–∞—Ç—É—Ä–µ:

### 1. **Overlay Mode** (–ü–æ —É–º–æ–ª—á–∞–Ω–∏—é) ‚úÖ –†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è

**–ö–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç:**
- –°–æ–∑–¥–∞–µ—Ç—Å—è –ø—Ä–æ–∑—Ä–∞—á–Ω—ã–π HTML overlay –ø–æ–≤–µ—Ä—Ö AlphaTab canvas
- –ò—Å–ø–æ–ª—å–∑—É–µ—Ç `includeNoteBounds` API –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è —Ç–æ—á–Ω—ã—Ö –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç –Ω–æ—Ç
- –ù–∞–∑–≤–∞–Ω–∏—è –Ω–æ—Ç –Ω–∞–∫–ª–∞–¥—ã–≤–∞—é—Ç—Å—è –ø–æ–≤–µ—Ä—Ö —Ü–∏—Ñ—Ä —Å –±–µ–ª—ã–º –∫–æ–Ω—Ç—É—Ä–æ–º
- –¶–∏—Ñ—Ä—ã —Å—Ç–∞–Ω–æ–≤—è—Ç—Å—è –ø–æ–ª—É–ø—Ä–æ–∑—Ä–∞—á–Ω—ã–º–∏ (opacity: 0.15)

**–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞:**
- ‚úÖ **–¢–æ—á–Ω–æ–µ –ø–æ–∑–∏—Ü–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ** - –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã –±–µ—Ä—É—Ç—Å—è –∏–∑ bounds API
- ‚úÖ **–ì–∏–±–∫–∞—è —Å—Ç–∏–ª–∏–∑–∞—Ü–∏—è** - –º–æ–∂–Ω–æ –º–µ–Ω—è—Ç—å —Ü–≤–µ—Ç, —à—Ä–∏—Ñ—Ç, —Ä–∞–∑–º–µ—Ä
- ‚úÖ **–ù–∞–¥–µ–∂–Ω–æ—Å—Ç—å** - –Ω–µ –∑–∞–≤–∏—Å–∏—Ç –æ—Ç –≤–Ω—É—Ç—Ä–µ–Ω–Ω–µ–π —Å—Ç—Ä—É–∫—Ç—É—Ä—ã AlphaTab
- ‚úÖ **–ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å** - overlay —Å–æ–∑–¥–∞–µ—Ç—Å—è –æ–¥–∏–Ω —Ä–∞–∑

**–ù–µ–¥–æ—Å—Ç–∞—Ç–∫–∏:**
- ‚ö†Ô∏è –¶–∏—Ñ—Ä—ã –≤—Å–µ –µ—â–µ –≤–∏–¥–Ω—ã –ø–æ–¥ –±—É–∫–≤–∞–º–∏ (–ø–æ–ª—É–ø—Ä–æ–∑—Ä–∞—á–Ω—ã–µ)

**–¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –¥–µ—Ç–∞–ª–∏:**
```typescript
// –ö–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã –∏–∑ NoteBounds API
const noteBounds = beatBounds.notes.find(nb => nb.note === note);
const x = noteBounds.noteHeadBounds.x + w / 2;
const y = noteBounds.noteHeadBounds.y + h / 2;

// –°–æ–∑–¥–∞–Ω–∏–µ overlay —ç–ª–µ–º–µ–Ω—Ç–∞
const noteLabel = document.createElement('div');
noteLabel.style.left = `${x}px`;
noteLabel.style.top = `${y}px`;
noteLabel.textContent = noteName; // "A", "B", "C#", etc.
```

---

### 2. **Replace Mode** (–≠–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–∞–ª—å–Ω—ã–π) ‚ö†Ô∏è

**–ö–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç:**
- –ü—ã—Ç–∞–µ—Ç—Å—è —Å–∫—Ä—ã—Ç—å —Ü–∏—Ñ—Ä—ã —á–µ—Ä–µ–∑ CSS `visibility: hidden`
- –ò—Å–ø–æ–ª—å–∑—É–µ—Ç —Ç–æ—Ç –∂–µ overlay, –Ω–æ —Å –ø–æ–ª–Ω—ã–º —Å–∫—Ä—ã—Ç–∏–µ–º —Ü–∏—Ñ—Ä
- –≠—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ = Overlay + visibility: hidden –¥–ª—è —Ü–∏—Ñ—Ä

**–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞:**
- ‚úÖ –¶–∏—Ñ—Ä—ã –ø–æ–ª–Ω–æ—Å—Ç—å—é —Å–∫—Ä—ã—Ç—ã
- ‚úÖ –ß–∏—Å—Ç—ã–π –≤–∏–¥ - —Ç–æ–ª—å–∫–æ –Ω–∞–∑–≤–∞–Ω–∏—è –Ω–æ—Ç

**–ù–µ–¥–æ—Å—Ç–∞—Ç–∫–∏:**
- ‚ùå **–û–≥—Ä–∞–Ω–∏—á–µ–Ω–æ canvas —Ä–µ–Ω–¥–µ—Ä–∏–Ω–≥–æ–º** - AlphaTab —Ä–µ–Ω–¥–µ—Ä–∏—Ç –≤ canvas, –Ω–µ HTML
- ‚ö†Ô∏è CSS —Å–µ–ª–µ–∫—Ç–æ—Ä—ã `.at-tab-number` –º–æ–≥—É—Ç –Ω–µ —Ä–∞–±–æ—Ç–∞—Ç—å
- ‚ö†Ô∏è –ù–µ–≤–æ–∑–º–æ–∂–Ω–æ –∏—Å—Ç–∏–Ω–Ω–æ "–∑–∞–º–µ–Ω–∏—Ç—å" —Ü–∏—Ñ—Ä—ã –Ω–∞ canvas

**–ü–æ—á–µ–º—É –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–æ:**
AlphaTab —Ä–µ–Ω–¥–µ—Ä–∏—Ç —Ç–∞–±—É–ª–∞—Ç—É—Ä—É –≤ `<canvas>`, –∞ –Ω–µ –≤ HTML —ç–ª–µ–º–µ–Ω—Ç—ã:
```
<canvas class="at-surface">
  <!-- –í—Å–µ —Ü–∏—Ñ—Ä—ã –Ω–∞—Ä–∏—Å–æ–≤–∞–Ω—ã –ø–∏–∫—Å–µ–ª—è–º–∏, –Ω–µ DOM —ç–ª–µ–º–µ–Ω—Ç–∞–º–∏ -->
</canvas>
```

–ü–æ—ç—Ç–æ–º—É CSS –∑–∞–º–µ–Ω–∞ —á–µ—Ä–µ–∑ `::before` –∏ `content` –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç.

**–¢–µ–∫—É—â–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è:**
```css
/* –ü—ã—Ç–∞–µ–º—Å—è —Å–∫—Ä—ã—Ç—å, –Ω–æ —ç—Ç–æ –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç –¥–ª—è canvas */
.note-names-replace .at-tab-number {
  visibility: hidden !important;
}
```

---

## –°—Ä–∞–≤–Ω–µ–Ω–∏–µ —Ä–µ–∂–∏–º–æ–≤

| –•–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∞ | Overlay Mode | Replace Mode |
|----------------|--------------|--------------|
| **–¢–æ—á–Ω–æ—Å—Ç—å** | ‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê | ‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê |
| **–ß–∏—Å—Ç–æ—Ç–∞ –≤–∏–¥–∞** | ‚≠ê‚≠ê‚≠ê (—Ü–∏—Ñ—Ä—ã –≤–∏–¥–Ω—ã) | ‚≠ê‚≠ê‚≠ê (—Ü–∏—Ñ—Ä—ã –≤–∏–¥–Ω—ã) |
| **–ù–∞–¥–µ–∂–Ω–æ—Å—Ç—å** | ‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê | ‚≠ê‚≠ê‚≠ê |
| **–ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å** | ‚≠ê‚≠ê‚≠ê‚≠ê | ‚≠ê‚≠ê‚≠ê‚≠ê |
| **–°—Ç–∏–ª–∏–∑–∞—Ü–∏—è** | ‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê | ‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê |
| **Canvas –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è** | –ù–µ—Ç | –î–∞ |

---

## –ö–∞–∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å

### –í UI:

1. –û—Ç–∫—Ä–æ–π—Ç–µ **–ù–∞—Å—Ç—Ä–æ–π–∫–∏** (‚öôÔ∏è)
2. –í–∫–ª—é—á–∏—Ç–µ **"–ü–æ–∫–∞–∑—ã–≤–∞—Ç—å –Ω–∞–∑–≤–∞–Ω–∏—è –Ω–æ—Ç –≤–º–µ—Å—Ç–æ –Ω–æ–º–µ—Ä–æ–≤ –ª–∞–¥–æ–≤"**
3. –í—ã–±–µ—Ä–∏—Ç–µ **–†–µ–∂–∏–º –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è**:
   - **Overlay** - –±—É–∫–≤—ã –ø–æ–≤–µ—Ä—Ö —Ü–∏—Ñ—Ä (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)
   - **Replace** - –∑–∞–º–µ–Ω–∏—Ç—å —Ü–∏—Ñ—Ä—ã (—ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–∞–ª—å–Ω–æ)

### Programmatic API:

```typescript
// –í–∫–ª—é—á–∏—Ç—å overlay mode
settingsService.updateSettings({
  display: {
    showNoteNames: true,
    noteNamesMode: 'overlay'
  }
});

// –í–∫–ª—é—á–∏—Ç—å replace mode
settingsService.updateSettings({
  display: {
    showNoteNames: true,
    noteNamesMode: 'replace'
  }
});
```

---

## –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –¥–µ—Ç–∞–ª–∏ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏

### Overlay Mode

```typescript
// 1. –ü–æ–ª—É—á–∞–µ–º bounds –Ω–æ—Ç
const boundsLookup = api.renderer.boundsLookup;
const beatBounds = boundsLookup.findBeat(beat);
const noteBounds = beatBounds.notes.find(nb => nb.note === note);

// 2. –°–æ–∑–¥–∞–µ–º overlay —ç–ª–µ–º–µ–Ω—Ç—ã
const overlay = document.createElement('div');
overlay.id = 'note-names-overlay';

beat.notes.forEach(note => {
  const label = document.createElement('div');
  label.className = 'note-name-label';
  label.textContent = midiToNoteName(note.realValue);
  label.style.left = `${noteX}px`;
  label.style.top = `${noteY}px`;
  overlay.appendChild(label);
});

// 3. –î–æ–±–∞–≤–ª—è–µ–º –≤ DOM
htmlContainer.appendChild(overlay);
```

### Replace Mode

```typescript
// 1. –î–æ–±–∞–≤–ª—è–µ–º CSS –∫–ª–∞—Å—Å
htmlContainer.classList.add('note-names-replace');

// 2. CSS –ø—ã—Ç–∞–µ—Ç—Å—è —Å–∫—Ä—ã—Ç—å —Ü–∏—Ñ—Ä—ã (–æ–≥—Ä–∞–Ω–∏—á–µ–Ω–æ –¥–ª—è canvas)
.note-names-replace .at-tab-number {
  visibility: hidden !important;
}

// 3. Overlay –≤—Å–µ —Ä–∞–≤–Ω–æ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è –±—É–∫–≤–µ–Ω–Ω–æ–≥–æ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è
// (canvas –Ω–µ–ª—å–∑—è –º–æ–¥–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞—Ç—å —á–µ—Ä–µ–∑ CSS)
```

---

## –ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω—ã–µ –ø–æ–¥—Ö–æ–¥—ã (–Ω–µ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω—ã)

### 1. Canvas Post-Processing

–ú–∞–Ω–∏–ø—É–ª—è—Ü–∏—è canvas –ø–æ—Å–ª–µ —Ä–µ–Ω–¥–µ—Ä–∏–Ω–≥–∞:

```typescript
api.renderFinished.on(() => {
  const canvas = api.canvasElement;
  const ctx = canvas.getContext('2d');
  
  // –ó–∞–∫—Ä–∞—à–∏–≤–∞–µ–º —Ü–∏—Ñ—Ä—ã –±–µ–ª—ã–º
  boundsLookup.staffSystems.forEach(system => {
    // ...–Ω–∞–π—Ç–∏ –ø–æ–∑–∏—Ü–∏–∏ —Ü–∏—Ñ—Ä
    ctx.fillStyle = 'white';
    ctx.fillRect(x, y, w, h);
  });
  
  // –†–∏—Å—É–µ–º –Ω–∞–∑–≤–∞–Ω–∏—è –Ω–æ—Ç
  ctx.fillStyle = '#667eea';
  ctx.fillText(noteName, x, y);
});
```

**–ü—Ä–æ–±–ª–µ–º—ã:**
- ‚ùå –°–ª–æ–∂–Ω–æ —Ç–æ—á–Ω–æ –Ω–∞–π—Ç–∏ –≥–¥–µ —Ü–∏—Ñ—Ä—ã
- ‚ùå –ú–æ–∂–µ—Ç –∑–∞—Ç—Ä–æ–Ω—É—Ç—å –¥—Ä—É–≥–∏–µ —ç–ª–µ–º–µ–Ω—Ç—ã (–ª–∏–Ω–∏–∏, –Ω–æ—Ç—ã)
- ‚ùå –ù–∞—Ä—É—à–∞–µ—Ç –¥—Ä—É–≥–∏–µ overlays AlphaTab

### 2. –§–æ—Ä–∫ AlphaTab

–ú–æ–¥–∏—Ñ–∏–∫–∞—Ü–∏—è –∏—Å—Ö–æ–¥–Ω–æ–≥–æ –∫–æ–¥–∞:

```typescript
// src/rendering/glyphs/TabNumberGlyph.ts
export class TabNumberGlyph extends Glyph {
  public paint(cx: number, cy: number, canvas: ICanvas): void {
    const displayValue = this.settings.showNoteNames 
      ? this.midiToNoteName(this.note.realValue)
      : this.noteValue.toString();
      
    canvas.fillText(displayValue, cx, cy);
  }
}
```

**–ü—Ä–æ–±–ª–µ–º—ã:**
- ‚ùå –ù—É–∂–Ω–æ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞—Ç—å —Ñ–æ—Ä–∫
- ‚ùå –°–ª–æ–∂–Ω–æ –æ–±–Ω–æ–≤–ª—è—Ç—å—Å—è
- ‚ùå Overkill –¥–ª—è –ø—Ä–æ—Å—Ç–æ–π —Ñ–∏—á–∏

---

## –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏

### –î–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π:
‚úÖ **–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ Overlay Mode** - –Ω–∞–¥–µ–∂–Ω—ã–π –∏ –∫—Ä–∞—Å–∏–≤—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç

### –î–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤:
- ‚úÖ Overlay mode - –æ–ø—Ç–∏–º–∞–ª—å–Ω–æ–µ —Ä–µ—à–µ–Ω–∏–µ
- ‚ö†Ô∏è Replace mode - proof of concept, –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è
- üí° –ï—Å–ª–∏ –Ω—É–∂–Ω–∞ –∏—Å—Ç–∏–Ω–Ω–∞—è –∑–∞–º–µ–Ω–∞ - —Ç–æ–ª—å–∫–æ —á–µ—Ä–µ–∑ —Ñ–æ—Ä–∫ AlphaTab

---

## FAQ

**Q: –ü–æ—á–µ–º—É —Ü–∏—Ñ—Ä—ã –≤—Å–µ –µ—â–µ –≤–∏–¥–Ω—ã –≤ Replace mode?**  
A: AlphaTab —Ä–µ–Ω–¥–µ—Ä–∏—Ç –≤ canvas, CSS –Ω–µ –º–æ–∂–µ—Ç –º–æ–¥–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞—Ç—å –ø–∏–∫—Å–µ–ª–∏. Replace mode –∏—Å–ø–æ–ª—å–∑—É–µ—Ç —Ç–æ—Ç –∂–µ overlay —á—Ç–æ –∏ Overlay mode.

**Q: –ú–æ–∂–Ω–æ –ª–∏ –ø–æ–ª–Ω–æ—Å—Ç—å—é —Å–∫—Ä—ã—Ç—å —Ü–∏—Ñ—Ä—ã?**  
A: –î–∞, –Ω–æ —Ç–æ–ª—å–∫–æ —á–µ—Ä–µ–∑:
1. Canvas post-processing (—Å–ª–æ–∂–Ω–æ, –Ω–µ–Ω–∞–¥–µ–∂–Ω–æ)
2. –§–æ—Ä–∫ AlphaTab (—Ç—Ä–µ–±—É–µ—Ç –ø–æ–¥–¥–µ—Ä–∂–∫–∏)

**Q: –ö–∞–∫–æ–π —Ä–µ–∂–∏–º –±—ã—Å—Ç—Ä–µ–µ?**  
A: –û–±–∞ –æ–¥–∏–Ω–∞–∫–æ–≤–æ –±—ã—Å—Ç—Ä—ã–µ, overlay —Å–æ–∑–¥–∞–µ—Ç—Å—è –æ–¥–∏–Ω —Ä–∞–∑.

**Q: –ú–æ–∂–Ω–æ –ª–∏ –∏–∑–º–µ–Ω–∏—Ç—å —Å—Ç–∏–ª—å –Ω–∞–∑–≤–∞–Ω–∏–π –Ω–æ—Ç?**  
A: –î–∞! –†–µ–¥–∞–∫—Ç–∏—Ä—É–π—Ç–µ CSS –∫–ª–∞—Å—Å `.note-name-label`:

```css
.note-name-label {
  color: #ff0000;      /* –ö—Ä–∞—Å–Ω—ã–π —Ü–≤–µ—Ç */
  font-size: 16px;     /* –ë–æ–ª—å—à–µ —Ä–∞–∑–º–µ—Ä */
  font-family: Arial;  /* –î—Ä—É–≥–æ–π —à—Ä–∏—Ñ—Ç */
}
```

---

## –ò—Ç–æ–≥

| –†–µ–∂–∏–º | –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è | –ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ |
|-------|--------------|------------|
| **Overlay** | ‚úÖ –†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è | –î–ª—è –≤—Å–µ—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π |
| **Replace** | ‚ö†Ô∏è –≠–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–∞–ª—å–Ω—ã–π | –î–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏—è –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–π canvas |

**–í—ã–≤–æ–¥:** Overlay mode - –ª—É—á—à–µ–µ –¥–æ—Å—Ç—É–ø–Ω–æ–µ —Ä–µ—à–µ–Ω–∏–µ –±–µ–∑ —Ñ–æ—Ä–∫–∞ AlphaTab! üé∏

